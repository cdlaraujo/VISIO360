<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visio3D Professional - Visualizador 3D Colaborativo</title>
    <link rel="stylesheet" href="/src/style.css" />
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>
    <div class="cad-layout">
        <header class="command-bar">
            <div class="logo-section">
                <img src="/nd-logo.avif" alt="Company Logo" class="company-logo">
                <span class="app-title">Visio3D Professional</span>
            </div>
            <nav class="main-menu">
                <button class="menu-item">Arquivo</button>
                <button class="menu-item">Editar</button>
                <button class="menu-item">Ver</button>
                <button class="menu-item">Ferramentas</button>
                <button class="menu-item">Colabora√ß√£o</button>
            </nav>
            <div class="user-section">
                <input type="text" id="user-name-input" class="user-name-field" placeholder="Seu nome" value="Usu√°rio">
                <button class="icon-btn" id="settings-btn" title="Configura√ß√µes">‚öôÔ∏è</button>
            </div>
        </header>

        <div class="tool-ribbon">
            <div class="ribbon-section">
                <label class="ribbon-label">Medi√ß√£o</label>
                <div class="ribbon-tools">
                    <button class="ribbon-btn" id="measure-tool-btn" title="Medir Dist√¢ncia (Ctrl+D)">
                        <span class="icon">üìè</span>
                        <span class="label">Dist√¢ncia</span>
                    </button>
                    <button class="ribbon-btn" id="area-tool-btn" title="Calcular √Årea Plana (Ctrl+A)">
                        <span class="icon">üìê</span>
                        <span class="label">√Årea</span>
                    </button>
                    <button class="ribbon-btn" id="surface-area-tool-btn" title="Calcular √Årea de Superf√≠cie (Ctrl+S)">
                        <span class="icon">üóª</span>
                        <span class="label">Superf√≠cie</span>
                    </button>
                </div>
            </div>
            <div class="ribbon-divider"></div>
            <div class="ribbon-section">
                <label class="ribbon-label">Modelo</label>
                <div class="ribbon-tools">
                    <button class="ribbon-btn" id="model-config-btn" title="Gerenciar Modelo (Ctrl+O)">
                        <span class="icon">üì¶</span>
                        <span class="label">Carregar</span>
                    </button>
                </div>
            </div>
            <div class="ribbon-divider"></div>
            <div class="ribbon-section">
                <label class="ribbon-label">Colabora√ß√£o</label>
                <div class="ribbon-tools">
                    <button class="ribbon-btn" id="create-room-btn" title="Criar Nova Sala">
                        <span class="icon">üöÄ</span>
                        <span class="label">Nova Sala</span>
                    </button>
                    <button class="ribbon-btn" id="join-room-btn" title="Entrar em Sala Existente">
                        <span class="icon">üîó</span>
                        <span class="label">Entrar</span>
                    </button>
                </div>
            </div>
            <div class="ribbon-divider"></div>
            <div class="ribbon-section">
                <label class="ribbon-label">Limpeza</label>
                <div class="ribbon-tools">
                    <button class="ribbon-btn clear-btn" id="clear-all-btn" title="Limpar Todas as Medi√ß√µes (Ctrl+Del)">
                        <span class="icon">üóëÔ∏è</span>
                        <span class="label">Limpar</span>
                    </button>
                </div>
            </div>
        </div>
        
        <div id="app"></div>

        <aside class="left-panel">
            <div class="panel-header">
                <h3>PROPRIEDADES</h3>
                <button class="icon-btn-small panel-toggle-left" title="Minimizar Painel">‚óÄ</button>
            </div>
            <div class="panel-content">
                <div id="model-info-section" class="property-group">
                    <h4>Modelo</h4>
                    <div class="property-item">
                        <label>Nome:</label>
                        <span id="model-name-display">Nenhum carregado</span>
                    </div>
                    <div class="property-item">
                        <label>Formato:</label>
                        <span id="model-format-display">-</span>
                    </div>
                    <div class="property-item">
                        <label>V√©rtices:</label>
                        <span id="model-vertices-display">-</span>
                    </div>
                </div>

                <div id="collaboration-section" class="property-group">
                    <h4>Colabora√ß√£o</h4>
                    
                    <div id="room-connect-controls" style="display: block;">
                        <button id="create-room-btn-panel" class="btn btn-success" style="width: 100%; margin-bottom: 8px;">üöÄ Criar Sala</button>
                        <button id="join-room-btn-panel" class="btn btn-secondary" style="width: 100%;">üîó Entrar em Sala</button>
                        
                        <div id="join-room-input" style="display: none; margin-top: 12px;">
                            <input type="text" id="room-id-input" class="input-field" placeholder="C√≥digo da sala ou URL">
                            <button id="join-room-confirm-btn" class="btn btn-primary" style="width: 100%; margin-top: 8px;">Conectar</button>
                            <button id="join-room-cancel-btn" class="btn btn-secondary" style="width: 100%; margin-top: 4px;">Cancelar</button>
                        </div>
                    </div>
                    
                    <div id="room-status" style="display: none;">
                        <div class="property-item">
                            <label>Status:</label>
                            <span id="connection-status" class="status-badge">Desconectado</span>
                        </div>
                        <div class="property-item">
                            <label>Sala:</label>
                            <span id="room-code-display" style="font-family: monospace; font-size: 0.85em; cursor: pointer;" title="Clique para copiar">-</span>
                        </div>
                        <div class="property-item">
                            <label>Participantes:</label>
                            <span id="peer-count">1</span>
                        </div>
                        <button id="disconnect-room-btn" class="btn btn-secondary" style="width: 100%; margin-top: 12px;">Desconectar</button>
                    </div>
                    
                    <div id="peers-container" style="margin-top: 12px; display: none;"></div>
                </div>
            </div>
        </aside>

        <aside class="right-panel">
            <div class="panel-header">
                <h3>MEDI√á√ïES</h3>
                <button class="icon-btn-small panel-toggle-right" title="Minimizar Painel">‚ñ∂</button>
            </div>
            <div class="panel-content">
                <div id="measurements-panel" class="measurements-panel">
                    <div id="measurements-container"></div>
                </div>
            </div>
        </aside>

        <footer class="status-bar">
            <div class="status-item">
                <span id="tool-instructions">Pronto</span>
            </div>
            <div class="status-item">
                <span id="coordinates">X: 0.00 | Y: 0.00 | Z: 0.00</span>
            </div>
            <div class="status-item">
                <span id="fps-counter">FPS: 60</span>
            </div>
        </footer>
    </div>

    <div id="model-loading-section" class="modal" style="display:none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Carregar Modelo 3D</h3>
                <button class="modal-close" id="close-model-modal">√ó</button>
            </div>
            <div class="modal-body">
                <div id="model-input-area">
                    <div class="input-group">
                        <label>URL do Modelo</label>
                        <input type="text" id="model-url-input" class="input-field" placeholder="https://exemplo.com/modelo.glb">
                        <button id="load-model-url-btn" class="btn btn-primary">Carregar via URL</button>
                    </div>
                    <div class="divider"><span>ou</span></div>
                    <div class="input-group">
                        <label for="model-input" class="custom-file-upload">
                            <span class="icon">üìÅ</span>
                            <span>Carregar do Computador</span>
                            <span class="file-hint">.ply, .gltf, .glb</span>
                        </label>
                        <input type="file" id="model-input" accept=".ply,.gltf,.glb" />
                    </div>
                </div>
                <div id="model-info-area" style="display:none;">
                    <p style="margin: 0 0 16px 0;">Modelo atual: <b id="current-model-name"></b></p>
                    <button id="change-model-btn" class="btn btn-secondary">Trocar Modelo</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="/src/main.js"></script>
</body>
</html>